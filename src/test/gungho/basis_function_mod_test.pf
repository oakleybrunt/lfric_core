!-------------------------------------------------------------------------------
! (c) The copyright relating to this work is owned jointly by the Crown, 
! Met Office and NERC 2014. 
! However, it has been created with the help of the GungHo Consortium, 
! whose members are identified at https://puma.nerc.ac.uk/trac/GungHo/wiki
!-------------------------------------------------------------------------------
!
!-------------------------------------------------------------------------------
module basis_function_mod_test
  implicit none 

contains

  @test
  subroutine test_basis_func()
    use pFUnit_Mod
    use basis_function_mod, only : basis_function_type
    use constants_mod, only : dp
    implicit none

    type(basis_function_type) :: basis_func
    integer :: ndofs_per_cell, vdim, vdim_diff
    real(kind=dp) :: basis,tol
    real(kind=dp) ,pointer :: whole_basis(:,:,:,:,:)
    real(kind=dp) ,pointer :: diff_basis(:,:,:,:,:)

    ndofs_per_cell = 4
    vdim = 1
    vdim_diff = 3
    basis_func = basis_function_type(ndofs_per_cell, vdim, vdim_diff, ngp = 3)

    basis = 0.5

    call basis_func%set_basis(basis,1,1,1,1,1)
    call basis_func%get_basis(whole_basis)

    tol = 1.0e-14
    @assertEqual( basis, whole_basis(1,1,1,1,1) )

    basis = 3.142_dp

    call basis_func%set_diff_basis(basis,2,3,2,1,1)
    call basis_func%get_diff_basis(diff_basis)
    @assertEqual( basis, diff_basis(2,3,2,1,1) )

  end subroutine test_basis_func

end module basis_function_mod_test
